SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[GetPendingApprovals]
    @RoleID VARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;

    SELECT * 
    FROM Trn_Inward_Old_Invoice
    WHERE 
        (
            -- For Inward_Type = 'D'
            (Inward_Type = 'D' AND Approval1_Status = 'Waiting' AND @RoleID = '7')
            OR
            (Inward_Type = 'D' AND Approval2_Status = 'Waiting' AND @RoleID IN ('6', '10'))
        )
        OR
        (
            -- For Inward_Type = 'S'
            (Inward_Type = 'S' AND Approval1_Status = 'Waiting' AND @RoleID = '3')
            OR
            (Inward_Type = 'S' AND Approval2_Status = 'Waiting' AND @RoleID = '7')
            OR
            (Inward_Type = 'S' AND Approval3_Status = 'Waiting' AND @RoleID = '6')
        )
END;
GO
