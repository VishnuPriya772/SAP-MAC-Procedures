SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[GetPurchaseDetails]
@UserID Varchar(50)
AS
BEGIN
    SELECT i.Inward_ID ,
	i.Vendor_ID,
	v.Vendor_Code,
	v.Vendor_Name,
	CONVERT(VARCHAR(10), i.Invoice_Date, 120) AS Invoice_Date,
	i.Invoice_No,
	i.Invoice_Qty,
	i.Invoice_Value,
	i.Purchase_Order,
	i.Material_ID,
	m.Material_Code,
	i.Monthly_Scheduled_Qty,
	i.Current_Stock,
	i.Reason_For_Delay,
	i.Inward_Type,
	i.Status,
	u.Plant_ID
	from Trn_Inward_Old_Invoice i
    INNER JOIN 
       Mst_Vendor v
    ON 
       i.Vendor_ID = v.Vendor_ID
	    INNER JOIN 
       Mst_Material m
    ON 
       i.Material_ID = m.Material_ID
	    INNER JOIN 
       Mst_User u
    ON 
       i.Created_By =u.User_ID

	   where i.Inward_Type='D'And i.Created_By=@UserID  AND i.Status IN('New','Rejected')
    
END;
GO
